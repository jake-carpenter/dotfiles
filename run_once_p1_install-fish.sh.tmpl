#!/bin/bash

### Priority 1 - Install fish
echo -e "\n  üîé Verifying fish..."

# Install Brew if it's not available
{{ if eq .chezmoi.os "darwin" }}
  if ! command -v brew &> /dev/null; then
    echo -e "  üöÄ Installing homebrew..."
    echo -e "  üö® \033[31mYOU WIlL BE ASKED FOR YOUR PASSWORD\033[0m"
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    eval "$(/opt/homebrew/bin/brew shellenv)"
  fi

{{ end }}

# Install fish using known methods
if ! command -v fish &> /dev/null; then
  echo -e "  üò§ Fish shell not found.\n  Installing fish..."
  echo -e "  üö® \033[31mYOU WIlL BE ASKED FOR YOUR PASSWORD\033[0m"
  {{ if eq .chezmoi.os "darwin" }}
    brew install fish
    grep -q "/opt/homebrew/bin/fish" /etc/shells || echo "/opt/homebrew/bin/fish" | sudo tee -a /etc/shells
    chsh -s /opt/homebrew/bin/fish
  {{ else }}
    echo -e "\n  ‚ö†Ô∏è Please install fish shell manually for your operating system"
    exit 1
  {{ end }}
fi
